<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Filters | Revel - A Web Application Framework for Go!</title>
<link rel="icon" href="/img/favicon.ico" type="image/x-icon" /> 
<link rel="shortcut icon" href="/img/favicon.png" type="image/png" />

<link href="/js/bootstrap-3.3.7-dist/css/bootstrap.min.css" rel="stylesheet">
<link href="/js/bootstrap-3.3.7-dist/css/bootstrap-theme.min.css" rel="stylesheet">
<link href="/css/jekyll-github.css" rel="stylesheet">

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="/js/bootstrap-3.3.7-dist/js/bootstrap.min.js" type="text/javascript"></script>


<link href="/css/revel.17.css" rel="stylesheet">

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-35042202-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>


</head>

<body>
    
    

    
<nav class="navbar navbar-inverse ">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <div id="main-logo"><a ddclass="navbar-brand" href="/">Revel</a>
            </div>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                                
                <li >
                    <a href="/tutorial/index.html"><span class="glyphicon glyphicon-education" aria-hidden="true"></span> Tutorial</a></li>
                
                <li class="active">
                    <a href="/manual/index.html"><span class="glyphicon glyphicon-book" aria-hidden="true"></span> Manual</a></li>
                    
                <li >
                    <a href="/modules/index.html"><span class="glyphicon glyphicon-th-list" aria-hidden="true"></span> Modules</a></li>
                    
                    
                <li >
                    <a href="/examples/index.html"><span class="glyphicon glyphicon-sound-stereo" aria-hidden="true"></span> Examples</a></li>
                
                <li >
                    <a href="/quickref/index.html"><span class="glyphicon glyphicon-screenshot" aria-hidden="true"></span> Quick Ref</a></li>
                    
                    
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Project <span class="caret"></span></a>
                    <ul class="dropdown-menu" role="menu">
                        <li><a href="https://github.com/revel/" target="github"><span class="glyphicon glyphicon-object-align-horizontal" aria-hidden="true"></span> Revel project @ github</a></li>
                        <li class="divider"></li>
                        <li class="dropdown-header">Revel</li>
                            <li><a href="https://godoc.org/github.com/revel/revel" target="godoc"><span class="glyphicon glyphicon-hand-right" aria-hidden="true"></span> godoc</a></li>
                            <li><a href="https://github.com/revel/revel" target="github"><span class="glyphicon glyphicon-floppy-disk" aria-hidden="true"></span> Source code</a></li>
                            <li><a href="https://github.com/revel/revel/issues" starget="github"><span class="glyphicon glyphicon-th-list" aria-hidden="true"></span> Issues</a></li>
                        <li class="divider"></li>
                        <li class="dropdown-header">Revel command</li>
                            <li><a href="https://github.com/revel/cmd" target="github"><span class="glyphicon glyphicon-floppy-disk" aria-hidden="true"></span> Source code</a></li>
                            <li><a href="https://github.com/revel/cmd/issues" target="github"><span class="glyphicon glyphicon-th-list" aria-hidden="true"></span> Issues</a></li>
                        <li class="divider"></li>
                        <li class="dropdown-header">Modules</li>
                        <li><a href="https://github.com/revel/modules" target="github"><span class="glyphicon glyphicon-floppy-disk" aria-hidden="true"></span> Source code</a></li>
                        <li class="divider"></li>
                        <li class="dropdown-header">Example Apps</li>
                        <li><a href="https://github.com/revel/examples" target="github"><span class="glyphicon glyphicon-floppy-disk" aria-hidden="true"></span> Source code</a></li>
                        <li class="divider"></li>
                        <li class="dropdown-header">revel.github.io</li>
                        <li><a href="https://github.com/revel/revel.github.io" target="github"><span class="glyphicon glyphicon-floppy-disk" aria-hidden="true"></span> Source code</a></li>
                        <li><a href="https://github.com/revel/revel.github.io/issues" starget="github"><span class="glyphicon glyphicon-th-list" aria-hidden="true"></span> Issues</a></li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Support <span class="caret"></span></a>
                    <ul class="dropdown-menu" role="menu">
                        <li><a href="https://gitter.im/revel/community" target="_blank">Chat on gitter.im</a></li>
                        <li><a href="http://stackoverflow.com/questions/tagged/revel" target="_blank">Revel at StackOverflow</a></li>
                    </ul>
                <li>
                 
            </ul>
        </div>
    </div>
</nav>


    <div class="container revel-manual">
        <div class="row">
            <div class="col-md-3">
                <div class="leftnav">
    <ul class="nav">
        
            <li class="nav-header">Overview</li>
            
                
                
                    <li><a href="index.html">Introduction</a></li>
                
            
                
                
                    <li><a href="concepts.html">Concepts</a></li>
                
            
                
                
                    <li><a href="organization.html">Code Organization</a></li>
                
            
        
            <li class="nav-header">Controllers</li>
            
                
                
                    <li><a href="controllers.html">Controllers Overview</a></li>
                
            
                
                
                    <li><a href="routing.html">URL Routing</a></li>
                
            
                
                
                    <li><a href="/modules/static.html">Static Content</a></li>
                
            
                
                
                    <li><a href="parameters.html">Request Parameters & JSON</a></li>
                
            
                
                
                    <li><a href="validation.html">Validation</a></li>
                
            
                
                
                    <li><a href="sessionflash.html">Session & Flash</a></li>
                
            
                
                
                    <li><a href="results.html">Results & Response</a></li>
                
            
                
                
                    <li><a href="templates.html">Templates</a></li>
                
            
                
                
                    <li><a href="template-engine.html">Template Engine</a></li>
                
            
                
                
                    <li><a href="templates-go.html">Go Template Engine</a></li>
                
            
                
                
                    <li><a href="server-engine.html">Server Engine</a></li>
                
            
                
                
                    <li><a href="interceptors.html">Interceptors</a></li>
                
            
                
                
                    <li class="active"><a href="filters.html">Filters</a></li>
                
            
                
                
                    <li><a href="websockets.html">Websockets</a></li>
                
            
                
                
                    <li><a href="i18n-messages.html">Internationalization</a></li>
                
            
                
                
                    <li><a href="cache.html">Cache</a></li>
                
            
                
                
                    <li><a href="database.html">Database</a></li>
                
            
                
                
                    <li><a href="debug.html">Debugging</a></li>
                
            
                
                
                    <li><a href="/modules/testing.html">Testing</a></li>
                
            
        
            <li class="nav-header">Operational</li>
            
                
                
                    <li><a href="versions.html">Versions</a></li>
                
            
                
                
                    <li><a href="logging.html">Logging</a></li>
                
            
                
                
                    <li><a href="deployment.html">Deployment</a></li>
                
            
        
            <li class="nav-header">Reference</li>
            
                
                
                    <li><a href="appconf.html">app.conf</a></li>
                
            
                
                
                    <li><a href="tool.html">revel cmd</a></li>
                
            
                
                
                    <li><a href="faq.html">FAQ</a></li>
                
            
        
    </ul>
</div>

            </div>

            <div class="col-md-9">
                <div class="page-header">
                    <a href="https://github.com/revel/revel.github.io/edit/master/manual/filters.md" class="improve-page btn dbtn-info" target="_blank"><span class="glyphicon glyphicon-edit" aria-hidden="true"></span> Improve Page</a>
                    <h1>Filters</h1>
                </div>
                <div class="main">
                    <p><strong>Filters</strong> are the middleware and are individual functions that make up the
request processing pipeline.  They execute all of the frameworkâ€™s functionality.</p>

<p>The <a href="https://godoc.org/github.com/revel/revel#Filter">Filter</a> <code class="highlighter-rouge">type</code> is a simple function:</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="x">
    </span><span class="k">type</span><span class="x"> </span><span class="n">Filter</span><span class="x"> </span><span class="k">func</span><span class="p">(</span><span class="n">c</span><span class="x"> </span><span class="o">*</span><span class="n">Controller</span><span class="p">,</span><span class="x"> </span><span class="n">filterChain</span><span class="x"> </span><span class="p">[]</span><span class="n">Filter</span><span class="p">)</span><span class="x">

</span></code></pre></div></div>

<p>Each filter is responsible for pulling the next filter off of the filter chain
and invoking it. Below is the default filter stack:</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">// The default set of global filters.</span><span class="x">
</span><span class="c">// Can be set in an application on initialization.</span><span class="x">
</span><span class="k">var</span><span class="x"> </span><span class="n">Filters</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="p">[]</span><span class="n">Filter</span><span class="p">{</span><span class="x">
	</span><span class="n">PanicFilter</span><span class="p">,</span><span class="x">             </span><span class="c">// Recover from panics and display an error page instead.</span><span class="x">
	</span><span class="n">RouterFilter</span><span class="p">,</span><span class="x">            </span><span class="c">// Use the routing table to select the right Action</span><span class="x">
	</span><span class="n">FilterConfiguringFilter</span><span class="p">,</span><span class="x"> </span><span class="c">// A hook for adding or removing per-Action filters.</span><span class="x">
	</span><span class="n">ParamsFilter</span><span class="p">,</span><span class="x">            </span><span class="c">// Parse parameters into Controller.Params.</span><span class="x">
	</span><span class="n">SessionFilter</span><span class="p">,</span><span class="x">           </span><span class="c">// Restore and write the session cookie.</span><span class="x">
	</span><span class="n">FlashFilter</span><span class="p">,</span><span class="x">             </span><span class="c">// Restore and write the flash cookie.</span><span class="x">
	</span><span class="n">ValidationFilter</span><span class="p">,</span><span class="x">        </span><span class="c">// Restore kept validation errors and save new ones from cookie.</span><span class="x">
	</span><span class="n">I18nFilter</span><span class="p">,</span><span class="x">              </span><span class="c">// Resolve the requested language</span><span class="x">
	</span><span class="n">InterceptorFilter</span><span class="p">,</span><span class="x">       </span><span class="c">// Run interceptors around the action.</span><span class="x">
	</span><span class="n">CompressFilter</span><span class="p">,</span><span class="x">          </span><span class="c">// Compress the result.</span><span class="x">
	</span><span class="n">ActionInvoker</span><span class="p">,</span><span class="x">           </span><span class="c">// Invoke the action.</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre></div></div>

<h2 id="filter-chain-configuration">Filter chain configuration</h2>

<h3 id="global-configuration">Global configuration</h3>

<p>Applications may configure the filter chain by <strong>re-assigning</strong> the <a href="https://godoc.org/github.com/revel/revel#Filters">revel.Filters</a>
variable in <code class="highlighter-rouge">init()</code>. By default this will be in <a href="https://github.com/revel/revel/blob/master/skeleton/app/init.go"><code class="highlighter-rouge">app/init.go</code></a> for a newly
generated app.</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span><span class="x"> </span><span class="n">init</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="c">// The filters for my app</span><span class="x">
	</span><span class="n">revel</span><span class="o">.</span><span class="n">Filters</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="p">[]</span><span class="n">Filter</span><span class="p">{</span><span class="x">
		</span><span class="n">PanicFilter</span><span class="p">,</span><span class="x">             </span><span class="c">// Recover from panics and display an error page instead.</span><span class="x">
		</span><span class="n">RouterFilter</span><span class="p">,</span><span class="x">            </span><span class="c">// Use the routing table to select the right Action</span><span class="x">
		</span><span class="n">ParamsFilter</span><span class="p">,</span><span class="x">            </span><span class="c">// Parse parameters into Controller.Params.</span><span class="x">
		</span><span class="n">FilterConfiguringFilter</span><span class="p">,</span><span class="x"> </span><span class="c">// A hook for adding or removing per-Action filters.</span><span class="x">
		</span><span class="n">SessionFilter</span><span class="p">,</span><span class="x">           </span><span class="c">// Restore and write the session cookie.</span><span class="x">
		</span><span class="n">FlashFilter</span><span class="p">,</span><span class="x">             </span><span class="c">// Restore and write the flash cookie.</span><span class="x">
		</span><span class="n">ValidationFilter</span><span class="p">,</span><span class="x">        </span><span class="c">// Restore kept validation errors and save new ones from cookie.</span><span class="x">
		</span><span class="n">I18nFilter</span><span class="p">,</span><span class="x">              </span><span class="c">// Resolve the requested language</span><span class="x">
		</span><span class="n">InterceptorFilter</span><span class="p">,</span><span class="x">       </span><span class="c">// Run interceptors around the action.</span><span class="x">
		</span><span class="n">CompressFilter</span><span class="p">,</span><span class="x">          </span><span class="c">// Compress the result. [^1]</span><span class="x">
		</span><span class="n">ActionInvoker</span><span class="p">,</span><span class="x">           </span><span class="c">// Invoke the action.</span><span class="x">
	</span><span class="p">}</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre></div></div>

<p>Every <a href="https://godoc.org/github.com/revel/revel#Request">Request</a> is sent down this chain, from top to bottom.</p>

<h3 id="per-action-configuration">Per-Action configuration</h3>

<p>Although all requests are sent down the <code class="highlighter-rouge">revel.Filters</code> chain, Revel also
provides a
<code class="highlighter-rouge">FilterConfigurator</code>,
which allows the developer to add, insert, or remove filter stages based on the
<code class="highlighter-rouge">Action</code> or <code class="highlighter-rouge">Controller</code>.</p>

<p>This functionality is implemented by the <a href="https://godoc.org/github.com/revel/revel#FilterConfiguringFilter">FilterConfiguringFilter</a>, itself a
filter stage. For example to add a filter to all the actions for a <code class="highlighter-rouge">MyController</code> you can</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span><span class="x"> </span><span class="n">init</span><span class="p">()</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="n">revel</span><span class="o">.</span><span class="n">FilterController</span><span class="p">(</span><span class="n">MyController</span><span class="p">{})</span><span class="o">.</span><span class="n">Insert</span><span class="p">(</span><span class="n">MyAuthFilter</span><span class="p">,</span><span class="x"> </span><span class="n">revel</span><span class="o">.</span><span class="n">BEFORE</span><span class="p">,</span><span class="x"> </span><span class="n">revel</span><span class="o">.</span><span class="n">ActionInvoker</span><span class="p">)</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre></div></div>

<h2 id="implementing-a-filter">Implementing a Filter</h2>

<h3 id="keep-the-chain-going">Keep the chain going</h3>

<p>Filters are responsible for invoking the next filter to continue the request
processing.  This is generally done with an expression as shown here:</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">var</span><span class="x"> </span><span class="n">MyFilter</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="k">func</span><span class="p">(</span><span class="n">c</span><span class="x"> </span><span class="o">*</span><span class="n">revel</span><span class="o">.</span><span class="n">Controller</span><span class="p">,</span><span class="x"> </span><span class="n">fc</span><span class="x"> </span><span class="p">[]</span><span class="n">revel</span><span class="o">.</span><span class="n">Filter</span><span class="p">)</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="c">// .. do some pre-processing ..</span><span class="x">

	</span><span class="n">fc</span><span class="p">[</span><span class="m">0</span><span class="p">](</span><span class="n">c</span><span class="p">,</span><span class="x"> </span><span class="n">fc</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="p">])</span><span class="x"> </span><span class="c">// Execute the next filter stage.</span><span class="x">

	</span><span class="c">// .. do some post-processing ..</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre></div></div>

<h3 id="getting-the-app-controller-type">Getting the app Controller type</h3>

<p>Filters receive the base <a href="https://godoc.org/github.com/revel/revel#Controller">Controller</a> type as an
argument, rather than the actual Controller type that was invoked.  If your
filter requires access to the actual Controller type that was invoked, it may
grab it with the following trick:</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">var</span><span class="x"> </span><span class="n">MyFilter</span><span class="x"> </span><span class="o">=</span><span class="x"> </span><span class="k">func</span><span class="p">(</span><span class="n">c</span><span class="x"> </span><span class="o">*</span><span class="n">revel</span><span class="o">.</span><span class="n">Controller</span><span class="p">,</span><span class="x"> </span><span class="n">fc</span><span class="x"> </span><span class="p">[]</span><span class="n">revel</span><span class="o">.</span><span class="n">Filter</span><span class="p">)</span><span class="x"> </span><span class="p">{</span><span class="x">
	</span><span class="k">if</span><span class="x"> </span><span class="n">ac</span><span class="p">,</span><span class="x"> </span><span class="n">ok</span><span class="x"> </span><span class="o">:=</span><span class="x"> </span><span class="n">c</span><span class="o">.</span><span class="n">AppController</span><span class="o">.</span><span class="p">(</span><span class="o">*</span><span class="n">MyController</span><span class="p">);</span><span class="x"> </span><span class="n">ok</span><span class="x"> </span><span class="p">{</span><span class="x">
		</span><span class="c">// Have an instance of *MyController...</span><span class="x">
	</span><span class="p">}</span><span class="x">

	</span><span class="n">fc</span><span class="p">[</span><span class="m">0</span><span class="p">](</span><span class="n">c</span><span class="p">,</span><span class="x"> </span><span class="n">fc</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="p">])</span><span class="x"> </span><span class="c">// Execute the next filter stage.</span><span class="x">
</span><span class="p">}</span><span class="x">
</span></code></pre></div></div>

<div class="alert alert-info">
Note: this pattern is frequently an indicator that
<a href="interceptors.html"><code>interceptors</code></a> may be a better mechanism to accomplish the
desired functionality.
</div>


                    
<div class="revel-godoc-bar">
  <h6>GoDoc Reference</h6>
  <ul>
    <li>
      
      <a href="https://godoc.org/github.com/revel/revel#Filter" target="_revel_godoc">Filter</a>,
      
      <a href="https://godoc.org/github.com/revel/revel#Filters" target="_revel_godoc">Filters</a>
      
    </li>
  </ul>
</div>



                    
<div class="revel-github-bar">
  <h6>GitHub Labels</h6>
  <ul>
    <li><b>Issues: </b> 
      
      <a href="https://github.com/revel/revel/labels/topic-filter" target="_revel_issues">topic-filter</a> 
      
      
    </li>
    <li><b>Pull Requests: </b> 
      
      <a href="https://github.com/revel/revel/pulls?q=is%3Apr+is%3Aopen+label%3Atopic-filter" target="_revel_pull_requests">topic-filter</a>
      
      
    </li>
  </ul>
</div>



                </div>
            </div>
        </div>
        
        <footer>
            <p>&copy; Revel Team 2017 - Revel is released under the <a href="https://github.com/revel/revel/blob/master/LICENSE">MIT License</a></p>
        </footer>
    </div>
</body>
</html>

